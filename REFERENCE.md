# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`profile_hostbased_ssh::known_hosts`](#profile_hostbased_ssh--known_hosts): Manage /etc/ssh/ssh_known_hosts for both source and target nodes in a hostbased authentication scenario.
* [`profile_hostbased_ssh::pam_slurm_adopt`](#profile_hostbased_ssh--pam_slurm_adopt): Implement use of the pam_slurm_adopt module.
* [`profile_hostbased_ssh::shosts_equiv`](#profile_hostbased_ssh--shosts_equiv): Manage the shosts.equiv file on the target nodes.
* [`profile_hostbased_ssh::source`](#profile_hostbased_ssh--source): Configure a source/client to use hostbased authentication.
* [`profile_hostbased_ssh::target`](#profile_hostbased_ssh--target): Configure a target/server to accept hostbased authentication.

## Classes

### <a name="profile_hostbased_ssh--known_hosts"></a>`profile_hostbased_ssh::known_hosts`

Manage /etc/ssh/ssh_known_hosts for both source and target nodes in a hostbased authentication scenario.

Param data for this class is also used to built shosts.equiv for the target class.

This class is used by the target and source classes, but could also be used in a standalone fashion.

#### Parameters

The following parameters are available in the `profile_hostbased_ssh::known_hosts` class:

* [`hosts_data`](#-profile_hostbased_ssh--known_hosts--hosts_data)
* [`ssh_known_hosts_file`](#-profile_hostbased_ssh--known_hosts--ssh_known_hosts_file)

##### <a name="-profile_hostbased_ssh--known_hosts--hosts_data"></a>`hosts_data`

Data type: `Hash`

Hash of the form:
  <name_for_host_set_1>:
    domain: "ncsa.illinois.edu"
    key_type: "ecdsa-sha2-nistp256" # suitable for ssh_known_hosts
    key: "content of public key that identifies hosts in this set"
    hosts: # host-IP pairs
      login1: 141.142.X.Y
      login2: 141.142.X.Z
  <name_for_host_set_2>:
    domain: ...
    key_type: ...
    key: "..."
    hosts:
      ...
  ...

##### <a name="-profile_hostbased_ssh--known_hosts--ssh_known_hosts_file"></a>`ssh_known_hosts_file`

Data type: `Optional[String]`

Location of the ssh_known_hosts file (usually /etc/ssh/ssh_known_hosts).
Set this to undef/null if no ssh_known_hosts file should be managed.

### <a name="profile_hostbased_ssh--pam_slurm_adopt"></a>`profile_hostbased_ssh::pam_slurm_adopt`

Implement use of the pam_slurm_adopt module.

This module should be included on 'target' hosts that run slurmd.

Includes masking systemd-logind and removing pam_systemd from
the PAM stack:
  https://bugs.schedmd.com/show_bug.cgi?id=3912
  https://bugs.schedmd.com/show_bug.cgi?id=5920

#### Examples

##### 

```puppet
include profile_hostbased_ssh::pam_slurm_adopt
```

#### Parameters

The following parameters are available in the `profile_hostbased_ssh::pam_slurm_adopt` class:

* [`pam_config`](#-profile_hostbased_ssh--pam_slurm_adopt--pam_config)
* [`services_to_mask`](#-profile_hostbased_ssh--pam_slurm_adopt--services_to_mask)

##### <a name="-profile_hostbased_ssh--pam_slurm_adopt--pam_config"></a>`pam_config`

Data type: `Hash`

Hash of data to pass to augeasproviders_pam.

##### <a name="-profile_hostbased_ssh--pam_slurm_adopt--services_to_mask"></a>`services_to_mask`

Data type: `Array`

Array of services to stop and mask

### <a name="profile_hostbased_ssh--shosts_equiv"></a>`profile_hostbased_ssh::shosts_equiv`

Manage the shosts.equiv file on the target nodes. Could be
used in a standalone fashion (with proper Hiera data) but
intended to be used indirectly by including the target class.

#### Examples

##### 

```puppet
include profile_hostbased_ssh::shosts_equiv
```

#### Parameters

The following parameters are available in the `profile_hostbased_ssh::shosts_equiv` class:

* [`shosts_equiv_file`](#-profile_hostbased_ssh--shosts_equiv--shosts_equiv_file)

##### <a name="-profile_hostbased_ssh--shosts_equiv--shosts_equiv_file"></a>`shosts_equiv_file`

Data type: `Optional[String]`

Path to shosts.equiv file. Set to undef/null if no shosts.equiv
file should be managed.

### <a name="profile_hostbased_ssh--source"></a>`profile_hostbased_ssh::source`

Configure a source/client to use hostbased authentication.

Borrows from ncsa/puppet-sshd

#### Examples

##### 

```puppet
include profile_hostbased_ssh::source
```

#### Parameters

The following parameters are available in the `profile_hostbased_ssh::source` class:

* [`global_custom_config`](#-profile_hostbased_ssh--source--global_custom_config)
* [`host_match_custom_config`](#-profile_hostbased_ssh--source--host_match_custom_config)
* [`host_match_pattern`](#-profile_hostbased_ssh--source--host_match_pattern)

##### <a name="-profile_hostbased_ssh--source--global_custom_config"></a>`global_custom_config`

Data type: `Hash`

Additional ssh_conf params (suitable for ssh_config global config...
although it will end up in a "Host *" block anyway)

##### <a name="-profile_hostbased_ssh--source--host_match_custom_config"></a>`host_match_custom_config`

Data type: `Hash`

Additional ssh_conf params (suitable for ssh_config match block)

##### <a name="-profile_hostbased_ssh--source--host_match_pattern"></a>`host_match_pattern`

Data type: `String`

Host pattern to match with 'Host' block. Use an empty string if
this should be omitted for some reason.

### <a name="profile_hostbased_ssh--target"></a>`profile_hostbased_ssh::target`

Configure a target/server to accept hostbased authentication.

Heavily based on profile_allow_ssh_from_bastion. Also borrows from
LSST: stdcfg::access

#### Examples

##### 

```puppet
include profile_hostbased_ssh::target
```

#### Parameters

The following parameters are available in the `profile_hostbased_ssh::target` class:

* [`groups`](#-profile_hostbased_ssh--target--groups)
* [`sshd_custom_config`](#-profile_hostbased_ssh--target--sshd_custom_config)
* [`sshd_match_nodelist`](#-profile_hostbased_ssh--target--sshd_match_nodelist)
* [`users`](#-profile_hostbased_ssh--target--users)

##### <a name="-profile_hostbased_ssh--target--groups"></a>`groups`

Data type: `Array[String]`

One or more LDAP / UNIX groups that are allowed to login from
any of the nodes in sshd_match_nodelist.

Note: This is set to [] by default, but one of `groups` or
      `users` must be set.

##### <a name="-profile_hostbased_ssh--target--sshd_custom_config"></a>`sshd_custom_config`

Data type: `Hash`

Additional sshd_conf params (suitable for sshd_config match block)

##### <a name="-profile_hostbased_ssh--target--sshd_match_nodelist"></a>`sshd_match_nodelist`

Data type: `Array[String, 1]`

List of hostnames / IPs / CIDRs from which to accept hostbased authentication.

Note: must contain at least 1 item

##### <a name="-profile_hostbased_ssh--target--users"></a>`users`

Data type: `Array[String]`

One or more LDAP / UNIX users that are allowed to login from
any of the nodes in sshd_match_nodelist.

Note: This is set to [] by default, but one of `groups` or
      `users` must be set.

